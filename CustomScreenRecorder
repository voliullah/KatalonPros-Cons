//for video recording add this file into the Test Listener folder along with another file uploaded with the name VideoRecoderListener and also add the monte screen recorder jar file to the driver folder of your system to record the failed test cases.

//Make sure that the jar file version is 0.7.7.0
//CustomScreenRecorder.groovy 

import org.monte.screenrecorder.ScreenRecorder
import org.monte.media.Format
import org.monte.media.FormatKeys
import org.monte.media.VideoFormatKeys
import org.monte.media.math.Rational
import java.awt.*
import java.io.File
import java.io.IOException

class CustomScreenRecorder extends ScreenRecorder {
    private String testName
    
    // Simplified constructor with default formats
    CustomScreenRecorder(GraphicsConfiguration cfg, File saveDir, String name) throws IOException, AWTException {
        super(
            cfg,
            new Rectangle(Toolkit.getDefaultToolkit().getScreenSize()),
            new Format(FormatKeys.MediaTypeKey, FormatKeys.MediaType.FILE, 
                     FormatKeys.MimeTypeKey, FormatKeys.MIME_AVI),
            new Format(FormatKeys.MediaTypeKey, FormatKeys.MediaType.VIDEO,
                     VideoFormatKeys.EncodingKey, VideoFormatKeys.ENCODING_AVI_TECHSMITH_SCREEN_CAPTURE,
                     VideoFormatKeys.CompressorNameKey, VideoFormatKeys.ENCODING_AVI_TECHSMITH_SCREEN_CAPTURE,
                     VideoFormatKeys.DepthKey, 24,
                     VideoFormatKeys.FrameRateKey, Rational.valueOf(8)),
            null, // mouse format
            null, // audio format
            saveDir)
        this.testName = name
    }

    protected File createMovieFile(Format fileFormat) throws IOException {
        if (!movieFolder.exists()) {
            movieFolder.mkdirs()
        }
        return new File(movieFolder, "${testName}_${System.currentTimeMillis()}.avi")
    }
}
